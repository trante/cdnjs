!function(a){var g=function(c){this.origHtmlMargin=parseFloat(a("html").css("margin-top"));this.options=a.extend({},a.smartbanner.defaults,c);c=navigator.standalone;var b=navigator.userAgent;this.options.force?this.type=this.options.force:null!=b.match(/iPhone|iPod/i)||b.match(/iPad/)&&this.options.iOSUniversalApp?null!=b.match(/Safari/i)&&(null!=b.match(/CriOS/i)||6>window.Number(b.substr(b.indexOf("OS ")+3,3).replace("_",".")))&&(this.type="ios"):b.match(/\bSilk\/(.*\bMobile Safari\b)?/)||b.match(/\bKF\w/)||
b.match("Kindle Fire")?this.type="kindle":null!=b.match(/Android/i)?this.type="android":null!=b.match(/Windows NT 6.2/i)&&null!==b.match(/Touch/i)&&(this.type="windows");!this.type||c||this.getCookie("sb-closed")||this.getCookie("sb-installed")||(this.scale="auto"==this.options.scale?a(window).width()/window.screen.width:this.options.scale,1>this.scale&&(this.scale=1),c=a("android"==this.type?'meta[name="google-play-app"]':"ios"==this.type?'meta[name="apple-itunes-app"]':"kindle"==this.type?'meta[name="kindle-fire-app"]':
'meta[name="msApplication-ID"]'),0!=c.length&&("windows"==this.type?(this.pfn=a('meta[name="msApplication-PackageFamilyName"]').attr("content"),this.appId=c.attr("content")[1]):this.appId=/app-id=([^\s,]+)/.exec(c.attr("content"))[1],this.title=this.options.title?this.options.title:c.data("title")||a("title").text().replace(/\s*[|\-\u00b7].*$/,""),this.author=this.options.author?this.options.author:c.data("author")||(a('meta[name="author"]').length?a('meta[name="author"]').attr("content"):window.location.hostname),
this.iconUrl=c.data("icon-url"),this.price=c.data("price"),this.create(),this.show(),this.listen()))};g.prototype={constructor:g,create:function(){var c,b=this.options.url?this.options.url:("windows"==this.type?"ms-windows-store:PDP?PFN="+this.pfn:"android"==this.type?"market://details?id=":"kindle"==this.type?"amzn://apps/android?asin=":"https://itunes.apple.com/"+this.options.appStoreLanguage+"/app/id")+this.appId,d=this.price||this.options.price,e=d?d+" - "+("android"==this.type?this.options.inGooglePlay:
"kindle"==this.type?this.options.inAmazonAppStore:"ios"==this.type?this.options.inAppStore:this.options.inWindowsStore):"",d=null===this.options.iconGloss?"ios"==this.type:this.options.iconGloss;this.options.url?b=this.options.url:"android"==this.type?(b="market://details?id="+this.appId,this.options.GooglePlayParams&&(b=b+"&referrer="+this.options.GooglePlayParams)):b="https://itunes.apple.com/"+this.options.appStoreLanguage+"/app/id"+this.appId;b='<div id="smartbanner" class="'+this.type+'"><div class="sb-container"><a href="#" class="sb-close">&times;</a><span class="sb-icon"></span><div class="sb-info"><strong>'+
this.title+"</strong><span>"+this.author+"</span><span>"+e+'</span></div><a href="'+b+'" class="sb-button"><span>'+this.options.button+"</span></a></div></div>";this.options.layer?a("body").append(b):a("body").prepend(b);this.options.icon?c=this.options.icon:this.iconUrl?c=this.iconUrl:0<a('link[rel="apple-touch-icon-precomposed"]').length?(c=a('link[rel="apple-touch-icon-precomposed"]').attr("href"),null===this.options.iconGloss&&(d=!1)):0<a('link[rel="apple-touch-icon"]').length?c=a('link[rel="apple-touch-icon"]').attr("href"):
0<a('meta[name="msApplication-TileImage"]').length?c=a('meta[name="msApplication-TileImage"]').attr("content"):0<a('meta[name="msapplication-TileImage"]').length&&(c=a('meta[name="msapplication-TileImage"]').attr("content"));c?(a("#smartbanner .sb-icon").css("background-image","url("+c+")"),d&&a("#smartbanner .sb-icon").addClass("gloss")):a("#smartbanner").addClass("no-icon");this.bannerHeight=a("#smartbanner").outerHeight()+2;1<this.scale&&(a("#smartbanner").css("top",parseFloat(a("#smartbanner").css("top"))*
this.scale).css("height",parseFloat(a("#smartbanner").css("height"))*this.scale).hide(),a("#smartbanner .sb-container").css("-webkit-transform","scale("+this.scale+")").css("-msie-transform","scale("+this.scale+")").css("-moz-transform","scale("+this.scale+")").css("width",a(window).width()/this.scale));a("#smartbanner").css("position",this.options.layer?"absolute":"static")},listen:function(){a("#smartbanner .sb-close").on("click",a.proxy(this.close,this));a("#smartbanner .sb-button").on("click",
a.proxy(this.install,this))},show:function(c){var b=a("#smartbanner");b.stop();this.options.layer?(b.animate({top:0,display:"block"},this.options.speedIn).addClass("shown").show(),a("html").animate({marginTop:this.origHtmlMargin+this.bannerHeight*this.scale},this.options.speedIn,"swing",c)):a.support.transition?(b.animate({top:0},this.options.speedIn).addClass("shown"),a("html").addClass("sb-animation").one(a.support.transition.end,function(){a("html").removeClass("sb-animation");c&&c()}).emulateTransitionEnd(this.options.speedIn).css("margin-top",
this.origHtmlMargin+this.bannerHeight*this.scale)):b.slideDown(this.options.speedIn).addClass("shown")},hide:function(c){var b=a("#smartbanner");b.stop();this.options.layer?(b.animate({top:0,display:"block"},this.options.speedIn).addClass("shown").show(),a("html").animate({marginTop:this.origHtmlMargin+this.bannerHeight*this.scale},this.options.speedIn,"swing",c)):a.support.transition?(b.css("top",-1*this.bannerHeight*this.scale).removeClass("shown"),a("html").addClass("sb-animation").one(a.support.transition.end,
function(){a("html").removeClass("sb-animation");c&&c()}).emulateTransitionEnd(this.options.speedOut).css("margin-top",this.origHtmlMargin)):b.slideUp(this.options.speedOut).removeClass("shown")},close:function(a){a.preventDefault();this.hide();this.setCookie("sb-closed","true",this.options.daysHidden)},install:function(a){this.options.hideOnInstall&&this.hide();this.setCookie("sb-installed","true",this.options.daysReminder)},setCookie:function(a,b,d){var e=new Date;e.setDate(e.getDate()+d);b=encodeURI(b)+
(null==d?"":"; expires="+e.toUTCString());document.cookie=a+"="+b+"; path=/;"},getCookie:function(a){var b,d,e,f=document.cookie.split(";");for(b=0;b<f.length;b++)if(d=f[b].substr(0,f[b].indexOf("=")),e=f[b].substr(f[b].indexOf("=")+1),d=d.replace(/^\s+|\s+$/g,""),d==a)return decodeURI(e);return null},switchType:function(){var c=this;this.hide(function(){c.type="android"==c.type?"ios":"android";var b=a("android"==c.type?'meta[name="google-play-app"]':'meta[name="apple-itunes-app"]').attr("content");
c.appId=/app-id=([^\s,]+)/.exec(b)[1];a("#smartbanner").detach();c.create();c.show()})}};a.smartbanner=function(c){var b=a(window),d=b.data("smartbanner");d||b.data("smartbanner",d=new g("object"==typeof c&&c));if("string"==typeof c)d[c]()};a.smartbanner.defaults={title:null,author:null,price:"FREE",appStoreLanguage:"us",inAppStore:"On the App Store",inGooglePlay:"In Google Play",inAmazonAppStore:"In the Amazon Appstore",inWindowsStore:"In the Windows Store",GooglePlayParams:null,icon:null,iconGloss:null,
button:"VIEW",url:null,scale:"auto",speedIn:300,speedOut:400,daysHidden:15,daysReminder:90,force:null,hideOnInstall:!0,layer:!1,iOSUniversalApp:!0};a.smartbanner.Constructor=g;void 0===a.support.transition&&(a.fn.emulateTransitionEnd=function(c){var b=!1,d=this;a(this).one(a.support.transition.end,function(){b=!0});setTimeout(function(){b||a(d).trigger(a.support.transition.end)},c);return this},a(function(){var c=a.support,b;a:{b=document.createElement("smartbanner");var d={WebkitTransition:"webkitTransitionEnd",
MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},e;for(e in d)if(void 0!==b.style[e]){b={end:d[e]};break a}b=!1}c.transition=b}))}(window.jQuery);
